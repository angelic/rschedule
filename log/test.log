  [4;36;1mSQL (1.8ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m
  [4;35;1mSQL (23.8ms)[0m   [0mCREATE DATABASE `plugins22_test` DEFAULT CHARACTER SET `utf8`[0m
  [4;36;1mSQL (1.8ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m
  [4;35;1mCalendar Delete all (0.0ms)[0m   [0mActiveRecord::ActiveRecordError: Table 'plugins22_test.calendars' doesn't exist: DELETE FROM `calendars` [0m
  [4;36;1mSQL (1.9ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m
  [4;35;1mSQL (89.2ms)[0m   [0mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB CHARACTER SET utf8 COLLATE utf8_bin[0m
  [4;36;1mSQL (232.4ms)[0m   [0;1mCREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`)[0m
  [4;35;1mSQL (2.2ms)[0m   [0mSELECT version FROM schema_migrations[0m
Migrating to AddActsAsCalendarTables (20090204171400)
  [4;36;1mSQL (84.9ms)[0m   [0;1mCREATE TABLE `calendars` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY) ENGINE=InnoDB CHARACTER SET utf8 COLLATE utf8_bin[0m
  [4;35;1mSQL (112.3ms)[0m   [0mCREATE TABLE `calendar_dates` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `value` date NOT NULL, `calendar_id` integer(10) NOT NULL, `weekday` integer(1) NOT NULL, `monthweek` integer(1) NOT NULL, `monthday` integer(1) NOT NULL, `lastweek` integer(1) DEFAULT 0 NOT NULL, `holiday` tinyint(1) DEFAULT 0 NOT NULL) ENGINE=InnoDB CHARACTER SET utf8 COLLATE utf8_bin[0m
  [4;36;1mSQL (80.7ms)[0m   [0;1mCREATE TABLE `calendar_events` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `calendar_id` integer(10) NOT NULL, `start_date` date, `end_date` date) ENGINE=InnoDB CHARACTER SET utf8 COLLATE utf8_bin[0m
  [4;35;1mSQL (80.5ms)[0m   [0mCREATE TABLE `calendar_occurrences` (`calendar_event_id` integer(10) NOT NULL, `calendar_date_id` integer(10) NOT NULL) ENGINE=InnoDB CHARACTER SET utf8 COLLATE utf8_bin[0m
  [4;36;1mSQL (88.5ms)[0m   [0;1mCREATE TABLE `calendar_recurrences` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `calendar_event_id` integer(10) NOT NULL, `weekday` integer(1), `monthweek` integer(1), `monthday` integer(1)) ENGINE=InnoDB CHARACTER SET utf8 COLLATE utf8_bin[0m
  [4;35;1mSQL (7.2ms)[0m   [0m
CREATE VIEW calendar_event_dates AS
SELECT
ce.id AS calendar_event_id,
cd.id AS calendar_date_id
FROM calendar_dates cd
INNER JOIN calendar_events ce ON cd.holiday = 'f' 
AND cd.calendar_id = ce.calendar_id
AND (ce.start_date IS NULL OR cd.value >= ce.start_date)
AND (ce.end_date IS NULL OR cd.value <= ce.end_date)
LEFT OUTER JOIN calendar_occurrences co
ON co.calendar_event_id = ce.id
AND co.calendar_date_id = cd.id
LEFT OUTER JOIN calendar_recurrences cr ON cr.calendar_event_id = ce.id
AND ((cr.monthday IS NOT NULL AND cd.monthday = cr.monthday)
OR (cr.monthday IS NULL AND cr.weekday IS NOT NULL
AND cd.weekday = cr.weekday
AND (cr.monthweek IS NULL OR cd.monthweek = cr.monthweek OR (cr.monthweek = -1 AND cd.lastweek = -1))
)
)
WHERE cr.id IS NOT NULL OR co.calendar_event_id IS NOT NULL
[0m
  [4;36;1mSQL (38.5ms)[0m   [0;1mINSERT INTO schema_migrations (version) VALUES ('20090204171400')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mSELECT version FROM schema_migrations[0m
  [4;36;1mSQL (1.8ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m
  [4;35;1mCalendar Delete all (0.5ms)[0m   [0mDELETE FROM `calendars` [0m
  [4;36;1mSQL (1.9ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m
  [4;35;1mCalendar Delete all (1.1ms)[0m   [0mDELETE FROM `calendars` [0m
  [4;36;1mSQL (1.9ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m
  [4;35;1mCalendar Delete all (0.4ms)[0m   [0mDELETE FROM `calendars` [0m
  [4;36;1mSQL (1.8ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m
  [4;35;1mCalendar Delete all (0.5ms)[0m   [0mDELETE FROM `calendars` [0m
